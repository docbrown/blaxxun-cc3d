<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<title>GvNode Include File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.0.0 on Thu Jan 27 18:48:54 2000 -->
<center>
<a class="qindex"href="index.html">Main Page</a> &nbsp; <a class="qindex"href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex"href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex"href="annotated.html">Compound List</a> &nbsp; <a class="qindex"href="files.html">File List</a> &nbsp; <a class="qindex"href="headers.html">Header Files</a> &nbsp; <a class="qindex"href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex"href="functions.html">Compound Members</a> &nbsp; <a class="qindex"href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>gvnode.h</h1>This is the verbatim text of the gvnode.h include file.<div class="fragment"><pre>/*=============================================================================

This code is licensed under the Web3D-blaxxun Community Source License,
provided in distribution file LICENSE.TXT and available online at
http://www.web3D.org/TaskGroups/x3d/blaxxun/Web3D-blaxxunCommunitySourceAgreement.html
and may only be used for non-commercial use as specified in that license.

THE WEB3D CONSORTIUM AND BLAXXUN DO NOT MAKE AND HEREBY DISCLAIM ANY EXPRESS
OR IMPLIED WARRANTIES RELATING TO THIS CODE, INCLUDING BUT NOT LIMITED TO,
WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE, OR ANY WARRANTIES THAT MIGHT ARISE FROM A COURSE OF DEALING, USAGE
OR TRADE PRACTICE.  THE COMMUNITY SOURCE CODE IS PROVIDED UNDER THIS
AGREEMENT "AS IS," WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, WARRANTIES THAT THE COMMUNITY SOURCE CODE ARE
FREE OF DEFECTS, MERCHANTABLE, FIT FOR A PARTICULAR PURPOSE OR
NON-INFRINGING OR IN ANY WAY CONSTITUTE THE COMPLETE PRODUCT MARKETED UNDER
THE NAMES GIVEN SAID CODE.

==============================================================================*/
#ifndef  _GV_NODE_
#define  _GV_NODE_

/******************************************************************************
@doc

@module GvNode.h - Declaration of VRML Root class GvNode|

Copyright (c) 1995 - 1999 by Holger Grahn
All rights reserved

Purpose:

Classes:

Notes:

Changes:

$Revision: 1.17 $
$Log: gvnode.h,v $
Revision 1.17  1999/07/06 16:35:10  tom
*** empty log message ***



Todo :

******************************************************************************/


#include &lt;gvstring.h&gt;
#include &lt;gvlists.h&gt;


#include "rt.h"
#include "array.h"
#include "stack.h"
#include "point.h"
#include "matrix.h"
#include "gclass.h"


// forwards
class <a class="code" href="class_astream.html">AStream</a>;
class <a class="code" href="class_gvchildlist.html">GvChildList</a>;
class <a class="code" href="class_gvdict.html">GvDict</a>;
class <a class="code" href="class_gvfielddata.html">GvFieldData</a>;
class <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a>;
class <a class="code" href="class_gvfield.html">GvField</a>;

class <a class="code" href="class_gvinput.html">GvInput</a>;
class <a class="code" href="class_gvnodelist.html">GvNodeList</a>;
class GvState;

class <a class="code" href="class_gvconnection.html">GvConnection</a>;

class <a class="code" href="class_gvscene.html">GvScene</a>;

class <a class="code" href="class_gvcopycontext.html">GvCopyContext</a>;

// to use a global, static node dictonary
// dictonarys keept in namespaces &amp; scene
//#define GV_GLOBAL_DICT


#ifdef _COM
// the COM EAI Interface declarations 
#include "glviewvrml.h"
#endif 



#include &lt;gvdict.h&gt;

//
// GvNode
// 

// derive GvNode from GClass node to get RT - Runtime Type information


class <a class="code" href="class_gvnode.html">GvNode</a> : 
        public <a class="code" href="class_gnode.html">GNode</a>

#ifdef _COM
        //,public CComObjectRoot
        ,public CComDualImpl&lt;Node, &amp;IID_Node, &amp;LIBID_GLViewVrmlLib&gt;
#endif

        {
public:

#ifdef _COM
        BEGIN_COM_MAP(<a class="code" href="class_gvnode.html">GvNode</a>)
                COM_INTERFACE_ENTRY(IDispatch)
                COM_INTERFACE_ENTRY(<a class="code" href="class_node.html">Node</a>)
        END_COM_MAP()

        DECLARE_NOT_AGGREGATABLE(<a class="code" href="class_gvnode.html">GvNode</a>)

        ULONG InternalAddRef()
        {
                ASSERT(refCnt &gt;= 0 &amp;&amp; refCnt &lt;= 64000);

                refCnt ++;
                return refCnt;
        }

        ULONG InternalRelease()
        {
                refCnt--;
                ASSERT(refCnt &gt;= 0 &amp;&amp; refCnt &lt;= 64000);
                return refCnt;
        }

        STDMETHOD_(ULONG, AddRef)() {
                //_Module.Lock();       // lock the ATL module 
                
                // how to Lock.m_browser ?
                return InternalAddRef();
        }
        STDMETHOD_(ULONG, Release)()
        {
                ULONG l = InternalRelease(); 
                if (l == 0) delete this; 
                //_Module.Unlock(); // unlock the ATL module 
                return l;
        }

        STDMETHOD(QueryInterface)(REFIID iid, void ** ppvObject)
        {return _InternalQueryInterface(iid, ppvObject);}

        // needed static Methods from CComObjectRoot 
        static HRESULT WINAPI InternalQueryInterface(void* pThis,
                const _ATL_INTMAP_ENTRY* entries, REFIID iid, void** ppvObject) {
                return CComObjectRoot::InternalQueryInterface(pThis,entries,iid,ppvObject);
        }
        static HRESULT WINAPI _Chain(void* pv, REFIID iid, void** ppvObject, DWORD dw)
        {
                return CComObjectRoot::_Chain(pv,iid,ppvObject,dw);
        }


    /* Node methods */
    STDMETHOD(getType)(BSTR * type);

    STDMETHOD(getEventIn)(BSTR name, <a class="code" href="class_eventin.html">EventIn</a>* *result);
    STDMETHOD(getEventOut)(BSTR name, <a class="code" href="class_eventout.html">EventOut</a>* *result);
    STDMETHOD(getField)(BSTR name, <a class="code" href="class_field.html">Field</a> ** result);
    STDMETHOD(getExposedField)(BSTR name, <a class="code" href="class_field.html">Field</a> ** result);

        // needed for Java SI
        STDMETHOD(getBrowser)(<a class="code" href="class_browser.html">Browser</a> **result);

        // name extension
    STDMETHOD(getName) (BSTR *name);
    STDMETHOD(setName) (BSTR name);

        // interface extension 
        STDMETHOD(getNumInterfaceElements)(/* [retval][out] */ int *result);
        
    STDMETHOD(getInterfaceElement)(
                        /* [in] */ int index,
            /* [out] */ int *elementType,
            /* [out] */ int *fieldType,
            /* [out] */ BSTR *name);
        
    STDMETHOD(getValueNode)( 
            /* [retval][out] */ <a class="code" href="class_node.html">Node</a> *  *result);

        STDMETHOD(getNative)(long *result) { *result = (long) (void *) this; return S_OK; }
 
    STDMETHOD(getRefCnt)(long *result) { *result = refCnt; return S_OK; }


        <a class="code" href="class_iunknown.html">IUnknown</a>* getIUnknown() {
                        <a class="code" href="class_iunknown.html">IUnknown</a>* result=NULL;
                        this-&gt;QueryInterface(IID_IUnknown, (void **)&amp;result);
                        return result;
        }

        // ATL 2.0 
        void Lock() {} // other impl could lock module in memory
        void Unlock() {}

#endif // COM 


  public:
        <a class="code" href="class_gnode.html#a0">RT</a>(<a class="code" href="class_ggeometry.html">GGeometry</a>);

    enum Stage {
           FIRST_INSTANCE,              
           PROTO_INSTANCE,              
           OTHER_INSTANCE,              
    };

/*
    enum Type {
       GEOMETRY_NODE=1,
       PROPERTY_NODE=2,
       TIME_DEPENDENT_NODE=4,
       VRML2_NODE=8,
       GLVIEW_NODE=16,
       IV_NODE=32,
       EXTENSION_NODE=64,
       SENSOR_NODE=128,
    };
*/

        <a class="code" href="class_gvnodelist.html">GvNodeList</a> owners;              
        <a class="code" href="class_gvnode.html">GvNode</a>*    m_browser;   

    inline <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_gvnode.html#a1">getBrowser</a>() const  { 
                // ASSERT(m_browser != NULL);
                return m_browser; 
        }
    
        void <a class="code" href="class_gvnode.html#a2">setBrowser</a>(<a class="code" href="class_gvnode.html">GvNode</a> * newBrowser) {
                m_browser = newBrowser;
                ASSERT(m_browser != NULL);
        }


    <a class="code" href="class_gvname.html">GvName</a>              *objName;
        
        //      flags;
        BEGIN_PACKED_STRUCT //    struct {
                unsigned int modified       : 1;  
                unsigned int isBuiltIn          : 1;  
                unsigned int copyOnInstance : 1;  
                // unsigned int isVrml2         : 1;  //!&lt; its a VRML 2 node 
                unsigned int needLightCheck     : 1;  
                unsigned int hasOutRoute        : 1;  
                unsigned int hasInRoute         : 1;  
                unsigned int hasBBox_           : 1;  
    END_PACKED_STRUCT // }; 


    <a class="code" href="class_gvnode.html#a3">GvNode</a>();
    
    virtual <a class="code" href="class_gvnode.html#a4">~GvNode</a>();

    const <a class="code" href="class_gvname.html">GvName</a> &amp;<a class="code" href="class_gvnode.html#a5">getName</a>() const;
    
    void <a class="code" href="class_gvnode.html#a6">setName</a>(const <a class="code" href="class_gvname.html">GvName</a> &amp;name,GvBool vrml2=TRUE);

        virtual const char * <a class="code" href="class_gvnode.html#a7">GetType</a>();
   
    virtual int <a class="code" href="class_gvnode.html#a8">GetNodeClassType</a>();

        int refCnt;  
        
        void <a class="code" href="class_gvnode.html#a9">ref</a>() { refCnt ++; }

        void <a class="code" href="class_gvnode.html#a10">unref</a>();
    
    void <a class="code" href="class_gvnode.html#a11">unrefNoDelete</a>() { refCnt--; }
        

        virtual void <a class="code" href="class_gvnode.html#a12">touch</a>();

        void <a class="code" href="class_gvnode.html#a13">untouch</a>() { modified = 0; }

        int <a class="code" href="class_gvnode.html#a14">touched</a>() const  { return(modified);}

        GvBool <a class="code" href="class_gvnode.html#a15">hasRoutes</a>() const { return hasOutRoute || hasInRoute; }
        GvBool <a class="code" href="class_gvnode.html#a16">hasOutRoutes</a>() const { return hasOutRoute; }
        GvBool <a class="code" href="class_gvnode.html#a17">hasInRoutes</a>() const { return hasInRoute; }
        inline GvBool <a class="code" href="class_gvnode.html#a18">hasBBox</a>() const { return hasBBox_; }


    static void <a class="code" href="class_gvnode.html#d0">init</a>();
    static void <a class="code" href="class_gvnode.html#d1">term</a>();
    

    virtual <a class="code" href="class_gvfielddata.html">GvFieldData</a> *<a class="code" href="class_gvnode.html#a19">getFieldData</a>() const = 0;

    virtual <a class="code" href="class_gvfield.html">GvField</a>* <a class="code" href="class_gvnode.html#a20">getField</a>(const char *fieldName) const;

    int  <a class="code" href="class_gvnode.html#a21">getFieldIndex</a>(const <a class="code" href="class_gvfield.html">GvField</a> *field) const;

    int <a class="code" href="class_gvnode.html#a22">getNumFields</a>() const;

    const <a class="code" href="class_gvname.html">GvName</a> &amp;<a class="code" href="class_gvnode.html#a23">getFieldName</a>(int index) const;

        <a class="code" href="class_gvname.html">GvName</a>  <a class="code" href="class_gvnode.html#a24">getEventOutName</a>(int index)  const; 

        <a class="code" href="class_gvname.html">GvName</a>  <a class="code" href="class_gvnode.html#a25">getEventInName</a>(int index)  const; 

    
    <a class="code" href="class_gvfieldentry.html">GvFieldEntry</a>* <a class="code" href="class_gvnode.html#a26">getFieldEntry</a>(int index) const;

    virtual <a class="code" href="class_gvfield.html">GvField</a> * <a class="code" href="class_gvnode.html#a20">getField</a>(int index) const;


    // get scene node, this node belongs to

#ifdef WIN32_TLS

        #define TLS_BROWSER 1
        #define TLS_REDRAW 2
        #define TLS_TIME 3

        // use WIN32 Task Local variables to avoid global trashing from differrent instances

    // get (current) browser node, this node belongs to
        // type of node is actually GView 
    //static GvNode* getBrowser()  { return ((GvNode*) TlsGetValue(TLS_BROWSER)); }
    //static void setBrowser(GvNode * newBrowser) { TlsSetValue(TLS_BROWSER,(void *) newBrowser); }

        // Redraw flag 

        // set redraw flag, marks node for redraw e.g. on field changes
        void <a class="code" href="class_gvnode.html#a28">setRedraw</a>() { TlsSetValue(TLS_REDRAW,(void *) 1); } 
        
        // clear redraw flag
        static void clearRedraw() { TlsSetValue(TLS_REDRAW, (void *) 0); } 
        
        // get redraw flag
        static BOOL <a class="code" href="class_gvnode.html#a29">getRedraw</a>()   { return (((int)TlsGetValue(TLS_REDRAW)) !=0); } 
        
        // set pointer to threads time variable
        static void setTimePtr(double *timePtr) { TlsSetValue(TLS_TIME,(void *) timePtr); }

        // get the current time 
        static double <a class="code" href="class_gvnode.html#a30">getTime</a>() { double *t = ((double *) TlsGetValue(TLS_TIME)); return *t; }; 

#else

/*
    // get (current) browser node, this node belongs to
        // type of node is actually GView 
    static GvNode* getBrowser()  { 
                                         // ASSERT(browser!=NULL);
                                        return(browser); 
                                }
    static void setBrowser(GvNode * newBrowser) { browser = newBrowser; }
        static GvNode* browser;
*/

#if 1
        // Redraw control, set flag on browser

        void <a class="code" href="class_gvnode.html#a28">setRedraw</a>();
        
        GvBool <a class="code" href="class_gvnode.html#a29">getRedraw</a>();

        // design problem, functions implemented in GModel.cpp

        double <a class="code" href="class_gvnode.html#a30">getTime</a>(); 
        double* <a class="code" href="class_gvnode.html#a31">getTimePtr</a>();  

#else
        // Redraw flag  - static global version - bad for WIN32 OCX

        // global redraw flag
        static GvBool mustRedraw;

        // set redraw flag, marks node for redraw e.g. on field changes
        void <a class="code" href="class_gvnode.html#a28">setRedraw</a>() { mustRedraw = TRUE; } 
        
        // clear redraw flag
        static void clearRedraw() { mustRedraw = FALSE; } 
        
        // get redraw flag
        static BOOL <a class="code" href="class_gvnode.html#a29">getRedraw</a>() { return mustRedraw; } 

        static double *theTime;
        static void setTimePtr(double *timePtr) { theTime = timePtr; }

        static double <a class="code" href="class_gvnode.html#a30">getTime</a>() 
        { 
                // TBD ASSERT(theTime!=NULL);
                if (theTime == NULL) return <a class="code" href="class_gtime.html#d0">GTime::GetGlobalTime</a>();
                return *theTime; 
        }; 
#endif

#endif



    virtual GvBool <a class="code" href="class_gvnode.html#a32">computeCopyOnInstance</a>(<a class="code" href="class_gvcopycontext.html">GvCopyContext</a> &amp;context);
   
    inline GvBool <a class="code" href="class_gvnode.html#a33">getCopyOnInstance</a>() const {  return(copyOnInstance); }

    void <a class="code" href="class_gvnode.html#a34">setCopyOnInstance</a>(GvBool flag) { copyOnInstance = flag; }

    inline GvBool <a class="code" href="class_gvnode.html#a35">getNeedLightCheck</a>() const {  return(needLightCheck); }
    inline void <a class="code" href="class_gvnode.html#a36">setNeedLightCheck</a>(GvBool flag) { needLightCheck = flag; }


        virtual GvBool <a class="code" href="class_gvnode.html#a37">getBBox</a>(<a class="code" href="class_bbox.html">BBox</a> &amp;bbox); // in GvTraverse.cpp

        virtual GvBool <a class="code" href="class_gvnode.html#a38">getBBoxEx</a>(<a class="code" href="class_bbox.html">BBox</a> &amp;bbox);


        virtual GvBool <a class="code" href="class_gvnode.html#a39">getMatrix</a>(<a class="code" href="class_matrix.html">Matrix</a> &amp;m); 

    //return true &amp;&amp; fieldName for field "field" in this node
    // or false if field not found

    //GvBool getFieldName(const GvField *field,GvName &amp;fieldName);


 //protected:
  public: 

  // private:

#ifdef GV_GLOBAL_DICT
    // global nameDict
    static <a class="code" href="class_gvdict.html">GvDict</a>       *nameDict;
#endif 



        // add node by name to global nameDict
    static void         <a class="code" href="class_gvnode.html#d2">addName</a>(<a class="code" href="class_gvnode.html">GvNode</a> *, const char *);

        // remove node by name from global nameDict
    static void         <a class="code" href="class_gvnode.html#d3">removeName</a>(<a class="code" href="class_gvnode.html">GvNode</a> *, const char *);
        
        // lookup for node by name in global nameDict
    static <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvnode.html#d4">findName</a>(const char *name);


    // read support

    virtual GvBool      <a class="code" href="class_gvnode.html#a40">readInstance</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in);

    static GvBool       <a class="code" href="class_gvnode.html#d5">read</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvnode.html">GvNode</a> *&amp;node);
   
    // read a node pointer (name)
    static <a class="code" href="class_gvnode.html">GvNode</a> *     <a class="code" href="class_gvnode.html#d6">readReference</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in);

    static GvBool <a class="code" href="class_gvnode.html#d7">readRoutesOrProtos</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in);

    static GvBool <a class="code" href="class_gvnode.html#d8">readRouteOrProto</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in,const <a class="code" href="class_gvname.html">GvName</a> &amp;name);

    static GvBool <a class="code" href="class_gvnode.html#d9">isRouteOrProto</a>(const <a class="code" href="class_gvname.html">GvName</a> &amp;name);

    static GvBool <a class="code" href="class_gvnode.html#d10">readRoute</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in);

    static GvBool       <a class="code" href="class_gvnode.html#d11">readNode</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, <a class="code" href="class_gvname.html">GvName</a> &amp;className,<a class="code" href="class_gvnode.html">GvNode</a> *&amp;node);

    static GvBool       <a class="code" href="class_gvnode.html#d12">readNodeInstance</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, const <a class="code" href="class_gvname.html">GvName</a> &amp;className,
                                              const <a class="code" href="class_gvname.html">GvName</a> &amp;refName, <a class="code" href="class_gvnode.html">GvNode</a> *&amp;node);

    static <a class="code" href="class_gvnode.html">GvNode</a> *     <a class="code" href="class_gvnode.html#d13">createInstance</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, const <a class="code" href="class_gvname.html">GvName</a> &amp;className);
    static void <a class="code" href="class_gvnode.html#d14">flushInput</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in);
        
        static <a class="code" href="class_gvnode.html">GvNode</a> *<a class="code" href="class_gvnode.html#d15">createProtoInstance</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in, const <a class="code" href="class_gvname.html">GvName</a> &amp;className);

    static <a class="code" href="class_gvnode.html">GvNode</a> *     <a class="code" href="class_gvnode.html#d16">createInstanceFromName</a>(const <a class="code" href="class_gvname.html">GvName</a> &amp;className,int vrml2);


        // ROUTE´s 

    static GvBool <a class="code" href="class_gvnode.html#d17">addRoute</a>(<a class="code" href="class_gvnode.html">GvNode</a> *from,int fromEventIndex,<a class="code" href="class_gvnode.html">GvNode</a> * to,int toEventIndex); 
    static GvBool <a class="code" href="class_gvnode.html#d18">deleteRoute</a>(<a class="code" href="class_gvnode.html">GvNode</a> *from,int fromEventIndex,<a class="code" href="class_gvnode.html">GvNode</a> * to,int toEventIndex); 

    static GvBool <a class="code" href="class_gvnode.html#d17">addRoute</a>(<a class="code" href="class_gvinput.html">GvInput</a> *in,
                        <a class="code" href="class_gvnode.html">GvNode</a> *from, const <a class="code" href="class_gvname.html">GvName</a>&amp; fromEvent,
                        <a class="code" href="class_gvnode.html">GvNode</a> *to, const <a class="code" href="class_gvname.html">GvName</a>&amp; toEvent);

        static GvBool <a class="code" href="class_gvnode.html#d20">sendEventIn</a>(<a class="code" href="class_gvfield.html">GvField</a> *fromField, <a class="code" href="class_gvnode.html">GvNode</a> * to,int toIndex);

    


   public:

    virtual int <a class="code" href="class_gnode.html#a3">Traverse</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state);
        
    int <a class="code" href="class_gvnode.html#a42">TraverseAllNodeFields</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state);
    int <a class="code" href="class_gvnode.html#a42">TraverseAllNodeFields</a>(<a class="code" href="class_gpathtraversal.html">GPathTraversal</a> &amp;state);

    void <a class="code" href="class_gvnode.html#a44">FlushAllNodeFields</a>();
      

    virtual int <a class="code" href="class_gnode.html#a4">Do</a>(<a class="code" href="class_gdisplaytreetraversal.html">GDisplayTreeTraversal</a> &amp;state); // implemented in GDisplayTree.cpp
        
        virtual int <a class="code" href="class_gnode.html#a4">Do</a>(<a class="code" href="class_goptimizetraversal.html">GOptimizeTraversal</a> &amp;state);      // implemented in GOptimizeTraversal.cpp


    // for GioTraversal only 
        int <a class="code" href="class_gnode.html#a4">Do</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);
        
        int <a class="code" href="class_gvnode.html#a48">DoNodeDef</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state,GvBool writeProto=TRUE);      // write out DEF name  or USE refeence if any

        int <a class="code" href="class_gvnode.html#a49">DoNodeClass</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);   // write classname 
        
        int <a class="code" href="class_gvnode.html#a50">DoNodeFields</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);  // write fields including fields [ ]
        
        int <a class="code" href="class_gvnode.html#a51">DoNodeBegin</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);   // start { and indent
        int <a class="code" href="class_gvnode.html#a52">DoNodeEnd</a>(<a class="code" href="class_giotraversal.html">GioTraversal</a> &amp;state);     // start } and un-indent
        // end gio traversal 
        
        virtual GvBool <a class="code" href="class_gvnode.html#a53">fieldsAreEqual</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *n) const;

        virtual <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvnode.html#a54">newInstance</a>();
        
        virtual GvBool <a class="code" href="class_gvnode.html#a55">copyFieldValues</a>(const <a class="code" href="class_gvnode.html">GvNode</a> *n);
        
        virtual <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvnode.html#a56">copy</a>(<a class="code" href="class_gvnode.html">GvNode</a> * resultNode = NULL,GvBool deep=FALSE);

        //virtual void setToDefaults();
        //virtual void hasDefaultValues();

        virtual int <a class="code" href="class_gvnode.html#a57">checkForDefaultValues</a>(int mode);


    virtual <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_gvnode.html#a59">Eval</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state); // side effect, may load EXTERNPROTO's and instance a ProtoIntace
    virtual <a class="code" href="class_gvnode.html">GvNode</a>* <a class="code" href="class_gvnode.html#a59">Eval</a>();     // 


        virtual int <a class="code" href="class_gvnode.html#a60">OnFieldChanged</a>(<a class="code" href="class_gvfield.html">GvField</a> *field);

        virtual int <a class="code" href="class_gvnode.html#a61">OnChanged</a>();

        virtual <a class="code" href="class_gvnode.html">GvNode</a> *<a class="code" href="class_gvnode.html#a62">EvalAs</a>(<a class="code" href="class_typeid.html">TypeId</a> type,int copyAttributes); 

    
    // connection handling

    friend class <a class="code" href="class_gvconnection.html">GvConnection</a>;
    
    virtual <a class="code" href="class_gvfield.html">GvField</a> * <a class="code" href="class_gvnode.html#a63">getEventIn</a>(const char *event);

    virtual <a class="code" href="class_gvfield.html">GvField</a> * <a class="code" href="class_gvnode.html#a64">getEventOut</a>(const char *event);


        // owner connection
        void <a class="code" href="class_gvnode.html#a65">addOwner</a>(<a class="code" href="class_gvnode.html">GvNode</a> *owner);
        void <a class="code" href="class_gvnode.html#a66">removeOwner</a>(<a class="code" href="class_gvnode.html">GvNode</a> *owner);

        void <a class="code" href="class_gvnode.html#a67">removeOwners</a>();

        GvBool <a class="code" href="class_gvnode.html#a68">replaceChildNode</a>(<a class="code" href="class_gvnode.html">GvNode</a> *oldNode,<a class="code" href="class_gvnode.html">GvNode</a> *newNode);
        GvBool <a class="code" href="class_gvnode.html#a69">replaceMe</a>(<a class="code" href="class_gvnode.html">GvNode</a> *newNode);
        
        virtual int <a class="code" href="class_gvnode.html#a70">OnChildChanged</a>(<a class="code" href="class_gvnode.html">GvNode</a> *child);

        virtual int <a class="code" href="class_gvnode.html#a71">NotifiyOwners</a>();

    <a class="code" href="class_gvconnection.html">GvConnection</a>* connections;
    
    GvBool <a class="code" href="class_gvnode.html#a72">hasConnections</a>() const { return(connections != NULL); }

    <a class="code" href="class_gvconnection.html">GvConnection</a>*  <a class="code" href="class_gvnode.html#a73">getConnections</a>() { return(connections); }
    
    int <a class="code" href="class_gvnode.html#a74">deleteConnections</a>();
    
    int <a class="code" href="class_gvnode.html#a75">addConnection</a>(<a class="code" href="class_gvconnection.html">GvConnection</a> *connection,GvBool trigger=FALSE);
    
    int <a class="code" href="class_gvnode.html#a76">removeConnection</a>(<a class="code" href="class_gvconnection.html">GvConnection</a> *connection);

        GvBool <a class="code" href="class_gvnode.html#a76">removeConnection</a>(GvBool (*Pred)(<a class="code" href="class_gvconnection.html">GvConnection</a> *c, void *data),void *data);

        <a class="code" href="class_gvconnection.html">GvConnection</a>* <a class="code" href="class_gvnode.html#a78">findConnection</a>(GvBool (*Pred)(<a class="code" href="class_gvconnection.html">GvConnection</a> *c, void *data),void *data);


    int <a class="code" href="class_gvnode.html#a79">removeConnections</a>(<a class="code" href="class_gvnode.html">GvNode</a> *node);

    int <a class="code" href="class_gvnode.html#a79">removeConnections</a>(<a class="code" href="class_gvfield.html">GvField</a> *field);


};



class <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a>
{
//protected :

public:
        <a class="code" href="class_gvnode.html">GvNode</a> *node;

public:

        operator <a class="code" href="class_gvnode.html">GvNode</a>*() const { return node;}

        <a class="code" href="class_gvnodehandle.html#a2">GvNodeHandle</a>(const <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a> &amp;newNode) 
                {
                   node = newNode.node;
           if (node) node-&gt;<a class="code" href="class_gvnode.html#a9">ref</a>();
                }

#ifdef _DEBUG_NODE_HANDLE
    
        <a class="code" href="class_gvnodehandle.html#a2">GvNodeHandle</a>();

        <a class="code" href="class_gvnodehandle.html#a2">GvNodeHandle</a>(<a class="code" href="class_gvnode.html">GvNode</a> * newNode); 

        void <a class="code" href="class_gvnodehandle.html#a3">destruct</a>();

        <a class="code" href="class_gvnodehandle.html#a4">~GvNodeHandle</a>();

        <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a>&amp; operator=(<a class="code" href="class_gvnode.html">GvNode</a> * newNode); 

#else

        <a class="code" href="class_gvnodehandle.html#a2">GvNodeHandle</a>() { node = NULL; }

        inline void <a class="code" href="class_gvnodehandle.html#a3">destruct</a>() { if (node) node-&gt;<a class="code" href="class_gvnode.html#a10">unref</a>(); node = NULL; }

        <a class="code" href="class_gvnodehandle.html#a4">~GvNodeHandle</a>() { if (node) node-&gt;<a class="code" href="class_gvnode.html#a10">unref</a>(); /* node = NULL; */ }

        inline <a class="code" href="class_gvnodehandle.html#a2">GvNodeHandle</a>(<a class="code" href="class_gvnode.html">GvNode</a> *newNode) 
                {
                   node = newNode;
           if (node) node-&gt;<a class="code" href="class_gvnode.html#a9">ref</a>();
                }
    
        inline <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a>&amp; operator=(<a class="code" href="class_gvnode.html">GvNode</a> * newNode) 
                {
                        if (node != newNode) {
                                if (node) node-&gt;<a class="code" href="class_gvnode.html#a10">unref</a>();                        
                                node = newNode;
                                if (node) node-&gt;<a class="code" href="class_gvnode.html#a9">ref</a>();                  
                        }

                        return(*this);
                }
#endif

        <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a>&amp; <a class="code" href="class_gvnodehandle.html#a7">set</a>(<a class="code" href="class_gvnode.html">GvNode</a> *newNode,<a class="code" href="class_gvnode.html">GvNode</a>* ownerNode);



    <a class="code" href="class_gvnode.html">GvNode</a>* operator-&gt;() { return (node); }
    const <a class="code" href="class_gvnode.html">GvNode</a>* operator-&gt;() const { return (node); }

        <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a>&amp; operator=(const <a class="code" href="class_gvnodehandle.html">GvNodeHandle</a> &amp;newNode) { return(*this = newNode.node); } 
  
    GvBool operator==(const <a class="code" href="class_gvnode.html">GvNode</a> * value) const { return(node == value);}
    
    <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvnodehandle.html#a13">Eval</a>(<a class="code" href="class_gtraversal.html">GTraversal</a> &amp;state) { if (!node) return(NULL); return node-&gt;<a class="code" href="class_gvnode.html#a59">Eval</a>(state); }
    <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvnodehandle.html#a13">Eval</a>() { if (!node) return(NULL); return node-&gt;<a class="code" href="class_gvnode.html#a59">Eval</a>(); }
};


// helper class for copying node trees 
// and avoiding recursive operations with self references scene graph
class <a class="code" href="class_gvcopycontext.html">GvCopyContext</a> {

private :

    <a class="code" href="class_gvdict.html">GvDict</a> nodeMap;     
        
        <a class="code" href="class_gvnode.html">GvNode</a> *browser; 

public :

    <a class="code" href="class_gvcopycontext.html#a0">GvCopyContext</a>(<a class="code" href="class_gvnode.html">GvNode</a> *theBrowser) : browser(theBrowser) {};
    <a class="code" href="class_gvcopycontext.html#a1">~GvCopyContext</a>() {};

        GvBool <a class="code" href="class_gvcopycontext.html#a2">alreadySeen</a>(<a class="code" href="class_gvnode.html">GvNode</a> * node);
        
        void <a class="code" href="class_gvcopycontext.html#a3">setSeen</a>(<a class="code" href="class_gvnode.html">GvNode</a> * node);


    void <a class="code" href="class_gvcopycontext.html#a4">put</a>(<a class="code" href="class_gvnode.html">GvNode</a> * oldNode, <a class="code" href="class_gvnode.html">GvNode</a> *newNode);

    <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvcopycontext.html#a5">get</a>(<a class="code" href="class_gvnode.html">GvNode</a> *oldNode);

    <a class="code" href="class_gvnode.html">GvNode</a> * <a class="code" href="class_gvcopycontext.html#a6">getBrowser</a>() { return browser; }


};




#endif /* _GV_NODE_ */

</div></pre><hr><address><small>Generated at Thu Jan 27 18:48:55 2000 for blaxxunContact3D by
<a href="http://www.stack.nl/~dimitri/doxygen/index.html">
<img src="doxygen.gif" alt="doxygen" align=center border=0 
width=118 height=53></a> 1.0.0 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy; 1997-1999</small></address>
</body>
</html>
